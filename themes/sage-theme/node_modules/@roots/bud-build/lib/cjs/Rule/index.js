"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.Rule = void 0;
const bud_support_1 = require("@roots/bud-support");
const Base_1 = require("../shared/Base");
/**
 * Framework Rule
 *
 * @public
 */
class Rule extends Base_1.Base {
    /**
     * Class constructor
     *
     * @public
     */
    constructor(app, options) {
        super();
        this.app = app;
        if (!options)
            return;
        options.test && this.setTest(options.test);
        options.use && this.setUse(options.use);
        options.include && this.setInclude(options.include);
        options.exclude && this.setExclude(options.exclude);
        options.type && this.setType(options.type);
        options.parser && this.setParser(options.parser);
        options.generator && this.setGenerator(options.generator);
    }
    /**
     * Test value
     *
     * @param app - Framework instance
     *
     * @public
     * @decorator `@bind`
     */
    getTest() {
        return this.test ? this.test(this.app) : null;
    }
    /**
     * Set test value
     *
     * @public
     * @decorator `@bind`
     */
    setTest(test) {
        this.test = this.normalizeInput(test);
        return this;
    }
    /**
     * Get parser value
     *
     * @public
     * @decorator `@bind`
     */
    getParser() {
        return this.parser ? this.parser(this.app) : null;
    }
    /**
     * Set parser value
     *
     * @public
     * @decorator `@bind`
     */
    setParser(parser) {
        this.parser = this.normalizeInput(parser);
        return this;
    }
    /**
     * Get use value
     *
     * @public
     * @decorator `@bind`
     */
    getUse() {
        return this.use ? this.use(this.app) : null;
    }
    /**
     * Set use value
     *
     * @public
     * @decorator `@bind`
     */
    setUse(use) {
        this.use = this.normalizeInput(use);
        return this;
    }
    /**
     * Get exclude value
     *
     * @public
     * @decorator `@bind`
     */
    getInclude() {
        return this.include ? this.include(this.app) : null;
    }
    /**
     * Set exclude value
     *
     * @public
     * @decorator `@bind`
     */
    setInclude(include) {
        this.include = this.normalizeInput(include);
        return this;
    }
    /**
     * Get exclude value
     *
     * @public
     * @decorator `@bind`
     */
    getExclude() {
        return this.exclude ? this.exclude(this.app) : null;
    }
    /**
     * Set exclude value
     *
     * @public
     * @decorator `@bind`
     */
    setExclude(exclude) {
        this.exclude = this.normalizeInput(exclude);
        return this;
    }
    /**
     * Get type value
     *
     * @public
     * @decorator `@bind`
     */
    getType() {
        return this.type ? this.type(this.app) : null;
    }
    /**
     * Set type value
     *
     * @public
     * @decorator `@bind`
     */
    setType(type) {
        this.type = this.normalizeInput(type);
        return this;
    }
    /**
     * Get generator value
     *
     * @public
     * @decorator `@bind`
     */
    getGenerator() {
        return this.generator ? this.generator(this.app) : null;
    }
    /**
     * Set generator value
     *
     * @public
     * @decorator `@bind`
     */
    setGenerator(generator) {
        this.generator = this.normalizeInput(generator);
        return this;
    }
    /**
     * Produce final Base output
     *
     * @param app - {@link @roots/bud-framework#Framework}
     * @returns finalized rule
     *
     * @public
     * @decorator `@bind`
     */
    make() {
        const output = {
            test: this.test(this.app),
        };
        this.use &&
            Object.assign(output, {
                use: this.use(this.app).map(item => item.make(this.app)),
            });
        this.include &&
            Object.assign(output, {
                include: this.include(this.app),
            });
        this.exclude &&
            Object.assign(output, {
                exclude: this.exclude(this.app),
            });
        this.type &&
            Object.assign(output, {
                type: this.type(this.app),
            });
        this.parser &&
            Object.assign(output, {
                parser: this.parser(this.app),
            });
        this.generator &&
            Object.assign(output, {
                generator: this.generator(this.app),
            });
        return output;
    }
}
__decorate([
    bud_support_1.bind
], Rule.prototype, "getTest", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "setTest", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "getParser", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "setParser", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "getUse", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "setUse", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "getInclude", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "setInclude", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "getExclude", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "setExclude", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "getType", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "setType", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "getGenerator", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "setGenerator", null);
__decorate([
    bud_support_1.bind
], Rule.prototype, "make", null);
exports.Rule = Rule;
